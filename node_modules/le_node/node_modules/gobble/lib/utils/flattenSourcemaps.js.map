{"version":3,"file":"flattenSourcemaps.js","sources":["../../../../src/utils/flattenSourcemaps.js"],"sourcesContent":["import { extname, resolve } from 'path';\nimport { lsr } from 'sander';\nimport * as mapSeries from 'promise-map-series';\nimport { load } from 'sorcery';\n\nconst whitelist = { '.js': true, '.css': true };\n\nexport default function flattenSourcemaps ( inputdir, outputdir, base, task ) {\n\treturn lsr( inputdir ).then( files => {\n\t\tconst jsAndCss = files.filter( file => whitelist[ extname( file ) ] );\n\n\t\treturn mapSeries( jsAndCss, file => {\n\t\t\treturn load( resolve( inputdir, file ) )\n\t\t\t\t.then( chain => {\n\t\t\t\t\tif ( chain ) {\n\t\t\t\t\t\treturn chain.write( resolve( outputdir, file ), { base });\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch( err => {\n\t\t\t\t\ttask.emit( 'error', err );\n\t\t\t\t});\n\t\t\t});\n\t})\n\t.then( () => inputdir );\n}"],"names":[],"mappings":";;;;;;;;;qBAOwB;AAFxB,IAAM,YAAY,EAAE,OAAO,MAAM,QAAQ;AAE1B,SAAS,kBAAoB,UAAU,WAAW,MAAM,MAAO;AAC7E,CAAD,iBAAW,CAAE,UAAW,KAAM,UAAA,OAAS;AACrC,EAAF,IAAQ,WAAW,MAAM,OAAQ,UAAA,MAAjC;AAAA,GAAA,OAAyC,sBAAkB,CAAE;AAA7D;;AAEE,EAAF,OAAS,UAAW,UAAU,UAAA,MAAQ;AACnC,GAAH,mBAAc,aAAS,CAAE,UAAU,OAC9B,KAAM,UAAA,OAAS;AACf,IAAL,IAAU,OAAQ;AACZ,KAAN,OAAa,MAAM,kBAAc,CAAE,WAAW,OAAQ,EAAE,MAAA;AACxD;AACA,MAAA,SACY,UAAA,KAAO;AACd,IAAL,KAAU,KAAM,SAAS;AACzB;AACA;AACA,IACE,KAAM,YADR;AACA,EAAA,OAAc;AAAd;AACA"}