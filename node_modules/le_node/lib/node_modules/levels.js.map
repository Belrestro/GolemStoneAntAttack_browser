{"version":3,"file":"levels.js","sources":["..\\src\\node_modules\\levels.js"],"sourcesContent":["\r\n// IMPORTS /////////////////////////////////////////////////////////////////////\r\n\r\nimport _                                    from 'lodash';\r\nimport * as defaults                        from 'defaults';\r\nimport text                                 from 'text';\r\nimport { BadOptionsError }                  from 'error';\r\n\r\n// LEVEL NUMBERS ///////////////////////////////////////////////////////////////\r\n\r\nexport const isNumberValid = n =>\r\n\tNumber.isInteger(parseFloat(n)) && _.inRange(n, 8);\r\n\r\n// NORMALIZATION & DEFAULTS ////////////////////////////////////////////////////\r\n\r\nconst normArr = (arr, opts) => {\r\n\tif (arr.length > 8)\r\n\t\tthrow new BadOptionsError(opts, text.tooManyLevels(arr.length));\r\n\r\n\treturn arr.map(val => {\r\n\t\tif (val && _.isString(val)) return val;\r\n\t\tif (_.isNumber(val) && isFinite(val)) return val.toString();\r\n\t\tif (_.isNull(val) || _.isUndefined(val)) return;\r\n\r\n\t\tthrow new BadOptionsError(opts, text.levelNotString(val));\r\n\t});\r\n};\r\n\r\nconst normObj = (obj, opts) => {\r\n\tconst lvlNums = _.values(obj);\r\n\r\n\tfor (const num of lvlNums) {\r\n\t\tif (!isNumberValid(num))\r\n\t\t\tthrow new BadOptionsError(opts, text.invalidLevelNum(num));\r\n\t}\r\n\r\n\tconst duplicates =\r\n\t\t_(obj).countBy().pick(lvl => lvl > 1).keys().value();\r\n\r\n\tif (duplicates.length)\r\n\t\tthrow new BadOptionsError(opts, text.duplicateLevelNums(duplicates));\r\n\r\n\treturn _.reduce(obj, (arr, i, name) => {\r\n\t\tarr[i] = name;\r\n\t\treturn arr;\r\n\t}, []);\r\n};\r\n\r\nexport const normalize = (opts) => {\r\n\r\n\tlet custom = opts.levels;\r\n\r\n\tif (!_.isUndefined(custom) && !_.isNull(custom) && !_.isObject(custom))\r\n\t\tthrow new BadOptionsError(opts, text.levelsNotObj(typeof custom));\r\n\r\n\tif (!custom)\r\n\t\treturn defaults.levels.slice();\r\n\r\n\tcustom = _.isArray(custom) ? normArr(custom, opts) : normObj(custom, opts);\r\n\r\n\tconst levels = defaults.levels.map((lvl, i) => custom[i] || lvl);\r\n\r\n\tconst duplicates =\r\n\t\t_(levels).countBy().pick(count => count > 1).keys().value();\r\n\r\n\tif (duplicates.length)\r\n\t\tthrow new BadOptionsError(opts, text.duplicateLevels(duplicates));\r\n\r\n\treturn levels;\r\n};\r\n"],"names":[],"mappings":"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"}